<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>êµ¬ë… ê°„í¸ì¡°íšŒ - ì´ë§ˆíŠ¸</title>
    <link rel="stylesheet" href="../shared/style.css">
    <link rel="stylesheet" href="../style.css">
    <link rel="stylesheet" href="../mobile.css">
    <script>window.CHANNEL = 'em';</script>
</head>
<body>
    <script src="/auth.js"></script>
    <div class="container">
        <!-- í—¤ë” -->
        <header class="header">
            <div class="header-content">
                <h1>êµ¬ë… ê°„í¸ì¡°íšŒ<span class="channel-version">&nbsp; (ì´ë§ˆíŠ¸) ver3</span></h1>
                <a href="/" class="back-to-main" style="position: fixed; right: 220px; top: 25px; text-decoration: none; color: #666; font-size: 13px; display: flex; align-items: center; gap: 5px; padding: 8px 12px; background: white; border-radius: 6px; transition: all 0.2s; box-shadow: 0 2px 8px rgba(0,0,0,0.1); border: 1px solid #ddd; height: 36px; box-sizing: border-box;" onmouseover="this.style.background='#f5f5f5'; this.style.color='#333';" onmouseout="this.style.background='white'; this.style.color='#666';">
                    <span style="font-size: 16px;">â†</span> ì±„ë„ ì„ íƒ
                </a>
            </div>
        </header>

        <div class="main-content">
            <!-- ì™¼ìª½ ê³„ì‚°ê¸° ì˜ì—­ -->
            <aside class="calculator-sidebar">
                <div class="calculator-header">
                    <h2>ê°€ì „êµ¬ë… í˜œíƒ</h2>
                    <label style="position: absolute; right: 10px; top: 50%; transform: translateY(-50%); display: flex; align-items: center; font-size: 12px; color: #666; cursor: pointer;">
                        <input type="checkbox" id="showTotalCost" style="margin-right: 5px; cursor: pointer;">
                        ì´í˜œíƒ ë³´ê¸°
                    </label>
                </div>
                
                <!-- êµ¬ë… íƒ€ì…ë³„ í˜œíƒ -->
                <div class="benefit-section">
                    <div class="benefit-item active" data-type="single">
                        <div class="benefit-title">ì •ìƒ êµ¬ë…ë£Œ</div>
                        <div class="benefit-price" id="normalPrice">0ì›</div>
                    </div>
                    
                    <div class="benefit-item" data-type="promotion">
                        <div class="benefit-header">
                            <div class="benefit-title">ì¶”ê°€í˜œíƒ</div>
                        </div>
                        <div class="benefit-price" id="promotionPrice">0ì›</div>
                        <div class="benefit-details" id="benefitDetails">
                            <div class="benefit-detail" id="promotionDiscountDetail">â€¢ í”„ë¡œëª¨ì…˜í• ì¸: 0ì›</div>
                            <div class="benefit-detail" id="combinationDiscountDetail">â€¢ ê²°í•©í• ì¸: 0ì›</div>
                            <div class="benefit-detail" id="partnerCardDetail">â€¢ ì œíœ´ì¹´ë“œ: 0ì›</div>
                        </div>
                    </div>
                    
                    <div class="benefit-item prepayment-section" id="prepaymentSection" style="display: none;">
                        <div class="benefit-title">ì„ ë‚©ê¸ˆì•¡ ğŸ’³</div>
                        <div class="benefit-price prepayment-price" id="prepaymentPrice">0ì›</div>
                        <div class="benefit-details">
                            <div class="benefit-detail small-text">ì„ ë‚© ì„ íƒ ì‹œ í•œë²ˆì— ë‚©ë¶€í•  ê¸ˆì•¡</div>
                            <div class="benefit-detail" id="prepaymentDetail">â€¢ í•´ë‹¹ ì œí’ˆ ì—†ìŒ</div>
                        </div>
                    </div>
                </div>
                
                <div class="final-total">
                    <div class="final-message">ìµœì¢… ì²´ê° êµ¬ë…ë£Œ(ì›”)ì…ë‹ˆë‹¤.</div>
                    <div class="final-price" id="finalPrice">0ì›</div>
                </div>
            </aside>

            <!-- ìš°ì¸¡ ì œí’ˆ ì„ íƒ ì˜ì—­ -->
            <main class="products-main">
                <div class="products-header">
                    <button id="subscriptionBenefitsBtn" class="subscription-benefits-btn">
                        <span class="benefits-icon">ğŸ</span>
                        <span>êµ¬ë… í˜œíƒ</span>
                    </button>
                </div>
                <div class="products-grid" id="productsGrid">
                    <!-- ì„ íƒëœ ì œí’ˆ ì¹´ë“œë“¤ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
                    <div class="add-product-card" id="addProductCard">
                        <div class="add-product-content">
                            <div class="add-icon">+</div>
                            <div class="add-text">ì œí’ˆ ì¶”ê°€</div>
                        </div>
                    </div>
                </div>
                
                <!-- ì›°ì»´ ë©”ì‹œì§€ (ì œí’ˆì´ ì—†ì„ ë•Œ) -->
                <div class="welcome-message" id="welcomeMessage">
                    <h3>êµ¬ë…í•˜ê³  ì‹¶ì€ ì œí’ˆì„ ì„ íƒí•´ë³´ì„¸ìš”</h3>
                    <p>ë‹¤ì–‘í•œ ê°€ì „ì œí’ˆì„ ì›” êµ¬ë…ë£Œë¡œ ì´ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
                </div>
            </main>
        </div>
        
        <!-- ì›Œí„°ë§ˆí¬ ì‹œê·¸ë‹ˆì²˜ -->
        <div class="watermark-signature">designed by í•˜ë™í›ˆ</div>
    </div>
    
    <!-- ëª¨ë°”ì¼ ì´í˜œíƒë³´ê¸° í† ê¸€ -->
    <div class="mobile-total-toggle" style="display: none;" id="mobileTotalToggle">
        <label>
            <input type="checkbox" id="mobileShowTotalCost">
            <span>ì´í˜œíƒ ë³´ê¸°</span>
        </label>
    </div>
    
    <!-- ëª¨ë°”ì¼ í•˜ë‹¨ í˜œíƒ ê³„ì‚° íŒ¨ë„ -->
    <div id="mobile-benefit-panel" class="mobile-benefit-panel collapsed" style="display: none;">
        <div class="mobile-benefit-header" onclick="toggleBenefitPanel()">
            <div style="display: flex; justify-content: space-between; align-items: center; width: 100%;">
                <span style="font-size: 14px; color: #fff;">ìµœì¢… ì²´ê° êµ¬ë…ë£Œ(ì›”)</span>
                <div style="display: flex; align-items: center; gap: 10px;">
                    <span id="mobile-final-price" style="font-size: 20px; font-weight: bold; color: #fff;">0ì›</span>
                    <span id="benefit-panel-arrow" style="font-size: 14px; color: #fff;">â–²</span>
                </div>
            </div>
        </div>
        <div class="mobile-benefit-content" style="padding: 20px;">
            <h3 style="font-size: 16px; margin: 0 0 15px 0; color: #333;">ê°€ì „êµ¬ë… í˜œíƒ</h3>
            
            <!-- ì •ìƒ êµ¬ë…ë£Œ -->
            <div style="background: #f8f9fa; padding: 12px; border-radius: 8px; margin-bottom: 10px;">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <span style="font-size: 14px; color: #666;">ì •ìƒ êµ¬ë…ë£Œ</span>
                    <span id="mobile-normal-price" style="font-size: 16px; font-weight: 600; color: #333;">0ì›</span>
                </div>
            </div>
            
            <!-- ì¶”ê°€í˜œíƒ -->
            <div style="background: #fff3cd; padding: 12px; border-radius: 8px; margin-bottom: 10px; border: 1px solid #ffc107;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                    <span style="font-size: 14px; color: #666;">ì¶”ê°€í˜œíƒ</span>
                    <span id="mobile-promotion-price" style="font-size: 16px; font-weight: 600; color: #dc3545;">0ì›</span>
                </div>
                <div id="mobile-benefit-details" style="font-size: 12px; color: #666;">
                    <div style="display: flex; justify-content: space-between; align-items: center; padding: 2px 0;">
                        <span>â€¢ í”„ë¡œëª¨ì…˜í• ì¸:</span>
                        <span id="mobile-promotion-discount">0ì›</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; align-items: center; padding: 2px 0;">
                        <span>â€¢ ê²°í•©í• ì¸:</span>
                        <span id="mobile-combination-discount">0ì›</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; align-items: center; padding: 2px 0;">
                        <span>â€¢ ì œíœ´ì¹´ë“œ:</span>
                        <span id="mobile-partner-card">0ì›</span>
                    </div>
                </div>
            </div>
            
            <!-- ì„ ë‚©ê¸ˆì•¡ (í•„ìš”ì‹œ í‘œì‹œ) -->
            <div id="mobile-prepayment-section" style="background: #e3f2fd; padding: 12px; border-radius: 8px; margin-bottom: 10px; border: 1px solid #2196f3; display: none;">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <span style="font-size: 14px; color: #666;">ì„ ë‚©ê¸ˆì•¡ ğŸ’³</span>
                    <span id="mobile-prepayment-price" style="font-size: 16px; font-weight: 600; color: #1976d2;">0ì›</span>
                </div>
                <div style="font-size: 11px; color: #666; margin-top: 5px;">ì„ ë‚© ì„ íƒ ì‹œ í•œë²ˆì— ë‚©ë¶€í•  ê¸ˆì•¡</div>
            </div>
            
            <!-- ìµœì¢… ê¸ˆì•¡ -->
            <div style="background: linear-gradient(135deg, #A50034, #8A002A); padding: 12px; border-radius: 8px; color: white; margin-bottom: 10px;">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <span style="font-size: 14px;">ìµœì¢… ì²´ê° êµ¬ë…ë£Œ(ì›”)</span>
                    <span id="mobile-final-price-detail" style="font-size: 18px; font-weight: bold;">0ì›</span>
                </div>
            </div>
            
            <!-- ì´í˜œíƒ ë³´ê¸° ì²´í¬ ì‹œ í‘œì‹œ -->
            <div id="mobile-total-cost-section" style="background: #f8f8fc; padding: 12px; border-radius: 8px; display: none; border: 1px solid #e0e0e0;">
                <div style="font-weight: bold; margin-bottom: 10px; color: #333; font-size: 14px;">ì „ì²´ ê³„ì•½ê¸°ê°„ ì´ ë¹„ìš©</div>
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 6px;">
                    <span style="font-size: 13px; color: #666;">ê³„ì•½ê¸°ê°„:</span>
                    <span id="mobile-contract-period" style="font-size: 13px; color: #333;">-</span>
                </div>
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 6px;">
                    <span style="font-size: 13px; color: #666;">ì •ê°€ í•©ê³„:</span>
                    <span id="mobile-total-original" style="font-size: 13px; color: #333;">0ì›</span>
                </div>
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 6px;">
                    <span style="font-size: 13px; color: #666;">ì´ í˜œíƒ:</span>
                    <span id="mobile-total-benefits" style="font-size: 13px; color: #dc3545;">-0ì›</span>
                </div>
                <div style="border-top: 1px solid #ddd; margin-top: 8px; padding-top: 8px; display: flex; justify-content: space-between; align-items: center;">
                    <span style="font-size: 14px; font-weight: bold; color: #333;">ì‹¤ ì§€ë¶ˆì´ì•¡:</span>
                    <span id="mobile-total-cost" style="font-size: 16px; font-weight: bold; color: #1976d2;">0ì›</span>
                </div>
            </div>
        </div>
    </div>

    <!-- ì œí’ˆ ì„ íƒ ëª¨ë‹¬ -->
    <div id="productModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>ì œí’ˆ ì„ íƒ</h2>
                <span class="close-btn" id="closeModal">&times;</span>
            </div>
            
            <!-- ë‹¨ê³„ í‘œì‹œê¸° -->
            <div class="step-indicator">
                <div class="step active" data-step="1">
                    <span class="step-number">1</span>
                    <span class="step-label">ì œí’ˆêµ°</span>
                </div>
                <div class="step" data-step="2">
                    <span class="step-number">2</span>
                    <span class="step-label">ëª¨ë¸ëª…</span>
                </div>
                <div class="step" data-step="3">
                    <span class="step-number">3</span>
                    <span class="step-label">ê²°í•©ìœ í˜•</span>
                </div>
                <div class="step" data-step="4">
                    <span class="step-number">4</span>
                    <span class="step-label">ê³„ì•½ê¸°ê°„</span>
                </div>
                <div class="step" data-step="5">
                    <span class="step-number">5</span>
                    <span class="step-label">ê´€ë¦¬ìœ í˜•</span>
                </div>
                <div class="step" data-step="6">
                    <span class="step-number">6</span>
                    <span class="step-label">ë°©ë¬¸ì£¼ê¸°</span>
                </div>
                <div class="step" data-step="7">
                    <span class="step-number">7</span>
                    <span class="step-label">ì„ ë‚©</span>
                </div>
            </div>

            <!-- ìŠ¤í¬ë¡¤ ê°€ëŠ¥í•œ ë‚´ìš© ì˜ì—­ -->
            <div class="modal-scroll-content">
                <!-- ë‹¨ê³„ë³„ ì„ íƒ ì˜ì—­ -->
                <div class="step-content">
                    <div class="step-header">
                        <div class="step-title" id="stepTitle">ì œí’ˆêµ°ì„ ì„ íƒí•´ì£¼ì„¸ìš”</div>
                        <button id="prevBtnTop" class="btn btn-secondary btn-small" style="display: none;">â† ì´ì „</button>
                    </div>
                    
                    <!-- ê²€ìƒ‰ì°½ (ë§ì€ ì˜µì…˜ì´ ìˆì„ ë•Œë§Œ í‘œì‹œ) -->
                    <div class="search-section" id="searchSection" style="display: none;">
                        <input type="text" id="optionSearch" placeholder="ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•˜ì„¸ìš”..." />
                        <div class="search-result-count" id="searchResultCount"></div>
                    </div>
                    
                    <div class="options-grid" id="optionsGrid">
                        <!-- ì„ íƒ ì˜µì…˜ë“¤ì´ ë™ì ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤ -->
                    </div>
                </div>

                <!-- ì„ íƒ ë‚´ì—­ í‘œì‹œ -->
                <div class="selection-summary">
                    <h4>ì„ íƒ ë‚´ì—­</h4>
                    <div class="selection-items" id="selectionItems">
                        <!-- ì„ íƒëœ ë‚´ì—­ë“¤ì´ í‘œì‹œë©ë‹ˆë‹¤ -->
                    </div>
                </div>

                <!-- ë²„íŠ¼ ì˜ì—­ (ìë™ ì§„í–‰ìœ¼ë¡œ ì¸í•´ ìˆ¨ê¹€) -->
                <div class="modal-footer" style="display: none;">
                    <button id="skipBtn" class="btn btn-secondary">ê±´ë„ˆë›°ê¸°</button>
                    <button id="addBtn" class="btn btn-success">ì œí’ˆ ì¶”ê°€</button>
                </div>
            </div>
        </div>
    </div>

    <!-- ì œíœ´ì¹´ë“œ ëª¨ë‹¬ -->
    <div id="partnerCardModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>ì œíœ´ì¹´ë“œ ì„ íƒ</h2>
                <span class="close-btn" onclick="calculator.closePartnerCardModal()">&times;</span>
            </div>
            
            <div class="modal-body">
                <p>ì œí’ˆì— ì ìš©í•  ì œíœ´ì¹´ë“œë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.</p>
                <div id="partnerCardOptions" class="partner-card-grid">
                    <!-- ì œíœ´ì¹´ë“œ ì˜µì…˜ë“¤ì´ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤ -->
                </div>
            </div>
            
            <div class="modal-footer">
                <button onclick="calculator.closePartnerCardModal()" class="btn btn-secondary">ì·¨ì†Œ</button>
                <button onclick="calculator.applyPartnerCard()" class="btn btn-primary">ì ìš©</button>
            </div>
        </div>
    </div>

    <!-- êµ¬ë… í˜œíƒ ëª¨ë‹¬ -->
    <div id="subscriptionBenefitsModal" class="modal">
        <div class="modal-content benefits-modal-content">
            <div class="modal-header">
                <h2>êµ¬ë… í˜œíƒ</h2>
                <span class="close-btn" onclick="closeBenefitsModal()">&times;</span>
            </div>
            
            <div class="modal-body">
                <p>êµ¬ë… ì‹œ ë°›ì„ ìˆ˜ ìˆëŠ” ë‹¤ì–‘í•œ ì¼€ì–´ ì„œë¹„ìŠ¤ í˜œíƒì„ í™•ì¸í•´ë³´ì„¸ìš”.</p>
                <div id="benefitsGrid" class="benefits-grid">
                    <!-- êµ¬ë… í˜œíƒ ë²„íŠ¼ë“¤ì´ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤ -->
                </div>
            </div>
        </div>
    </div>

    <!-- êµ¬ë… í˜œíƒ ìƒì„¸ ëª¨ë‹¬ -->
    <div id="benefitDetailModal" class="modal">
        <div class="modal-content benefit-detail-content">
            <div class="modal-header">
                <h2 id="benefitDetailTitle">í˜œíƒ ìƒì„¸</h2>
                <span class="close-btn" onclick="closeBenefitDetailModal()">&times;</span>
            </div>
            
            <div class="modal-body">
                <div id="benefitDetailContent">
                    <!-- ìƒì„¸ ë‚´ìš©ì´ ì—¬ê¸°ì— ë¡œë“œë©ë‹ˆë‹¤ -->
                </div>
            </div>
        </div>
    </div>

    <script src="../shared/script.js"></script>
    <script src="../product-modal.js"></script>
    <script src="../script.js"></script>
    
    <!-- ëª¨ë°”ì¼ UI ìŠ¤í¬ë¦½íŠ¸ -->
    <script>
    // createMobileButtons í•¨ìˆ˜ ì œê±° - ë” ì´ìƒ í•„ìš”ì—†ìŒ
    /*function createMobileButtons() {
        // ì´ë¯¸ ë²„íŠ¼ì´ ìˆìœ¼ë©´ ìƒì„±í•˜ì§€ ì•ŠìŒ
        if (document.getElementById('mobile-buttons-container')) return;
        
        // ëª¨ë°”ì¼ì—ì„œë§Œ ì‹¤í–‰
        if (window.innerWidth > 768) return;
        
        // í—¤ë” ì»¨í…ì¸  ì°¾ê¸°
        const headerContent = document.querySelector('.header-content');
        if (!headerContent) return;
        
        // 3ê°œ ë²„íŠ¼ ì»¨í…Œì´ë„ˆ ìƒì„±
        const buttonsContainer = document.createElement('div');
        buttonsContainer.id = 'mobile-buttons-container';
        buttonsContainer.style.cssText = `
            display: flex !important;
            gap: 8px !important;
            margin-top: 15px !important;
            width: 100% !important;
        `;
        
        // 1. êµ¬ë…í˜œíƒ ë²„íŠ¼
        const benefitsBtn = document.createElement('button');
        benefitsBtn.innerHTML = '<span style="font-size: 16px; margin-bottom: 2px;">ğŸ</span><br>êµ¬ë…í˜œíƒ';
        benefitsBtn.onclick = () => document.getElementById('subscriptionBenefitsBtn').click();
        benefitsBtn.style.cssText = `
            flex: 1 !important;
            padding: 10px 5px !important;
            background: white !important;
            border: 1px solid #ddd !important;
            border-radius: 8px !important;
            font-size: 11px !important;
            color: #333 !important;
            text-decoration: none !important;
            min-height: 50px !important;
            cursor: pointer !important;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1) !important;
            font-weight: 500 !important;
            line-height: 1.2 !important;
            display: flex !important;
            flex-direction: column !important;
            align-items: center !important;
            justify-content: center !important;
        `;
        
        // 2. ì±„ë„ì„ íƒ ë²„íŠ¼
        const channelBtn = document.createElement('a');
        channelBtn.href = '/';
        channelBtn.innerHTML = '<span style="font-size: 16px; margin-bottom: 2px;">ğŸª</span><br>ì±„ë„ì„ íƒ';
        channelBtn.style.cssText = `
            flex: 1 !important;
            padding: 10px 5px !important;
            background: white !important;
            border: 1px solid #ddd !important;
            border-radius: 8px !important;
            font-size: 11px !important;
            color: #333 !important;
            text-decoration: none !important;
            min-height: 50px !important;
            cursor: pointer !important;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1) !important;
            font-weight: 500 !important;
            line-height: 1.2 !important;
            display: flex !important;
            flex-direction: column !important;
            align-items: center !important;
            justify-content: center !important;
        `;
        
        // 3. ë¡œê·¸ì¸ì •ë³´ ë²„íŠ¼
        const loginBtn = document.createElement('button');
        loginBtn.innerHTML = '<span style="font-size: 16px; margin-bottom: 2px;">ğŸ‘¤</span><br>ë¡œê·¸ì¸ì •ë³´';
        loginBtn.onclick = () => {
            // ì‚¬ìš©ì ì •ë³´ í‘œì‹œ ë˜ëŠ” ë¡œê·¸ì•„ì›ƒ
            const userInfo = localStorage.getItem('user_info');
            if (userInfo) {
                const user = JSON.parse(userInfo);
                if (confirm(`${user.username}ë‹˜, ë¡œê·¸ì•„ì›ƒ í•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
                    handleLogout();
                }
            }
        };
        loginBtn.style.cssText = `
            flex: 1 !important;
            padding: 10px 5px !important;
            background: white !important;
            border: 1px solid #ddd !important;
            border-radius: 8px !important;
            font-size: 11px !important;
            color: #333 !important;
            text-decoration: none !important;
            min-height: 50px !important;
            cursor: pointer !important;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1) !important;
            font-weight: 500 !important;
            line-height: 1.2 !important;
            display: flex !important;
            flex-direction: column !important;
            align-items: center !important;
            justify-content: center !important;
        `;
        
        // ë²„íŠ¼ë“¤ì„ ì»¨í…Œì´ë„ˆì— ì¶”ê°€
        buttonsContainer.appendChild(benefitsBtn);
        buttonsContainer.appendChild(channelBtn);
        buttonsContainer.appendChild(loginBtn);
        
        // í—¤ë” ì»¨í…ì¸ ì— ì¶”ê°€
        headerContent.appendChild(buttonsContainer);
    }*/
    
    // í•˜ë‹¨ í˜œíƒ íŒ¨ë„ í† ê¸€ í•¨ìˆ˜
    function toggleBenefitPanel() {
        const panel = document.getElementById('mobile-benefit-panel');
        const arrow = document.getElementById('benefit-panel-arrow');
        
        if (panel.classList.contains('collapsed')) {
            panel.classList.remove('collapsed');
            panel.classList.add('expanded');
            arrow.textContent = 'â–¼';
        } else {
            panel.classList.remove('expanded');
            panel.classList.add('collapsed');
            arrow.textContent = 'â–²';
        }
    }
    
    // ëª¨ë°”ì¼ í˜œíƒ ê³„ì‚° íŒ¨ë„ ë°ì´í„° ì—…ë°ì´íŠ¸
    function updateMobileBenefitPanel() {
        // PCì˜ ê³„ì‚°ê¸° ë°ì´í„°ë¥¼ ëª¨ë°”ì¼ íŒ¨ë„ì— ë°˜ì˜
        const normalPrice = document.getElementById('normalPrice');
        const promotionPrice = document.getElementById('promotionPrice');
        const finalPrice = document.getElementById('finalPrice');
        const prepaymentSection = document.getElementById('prepaymentSection');
        const prepaymentPrice = document.getElementById('prepaymentPrice');
        
        if (normalPrice) document.getElementById('mobile-normal-price').textContent = normalPrice.textContent;
        if (promotionPrice) document.getElementById('mobile-promotion-price').textContent = promotionPrice.textContent;
        if (finalPrice) {
            document.getElementById('mobile-final-price').textContent = finalPrice.textContent;
            document.getElementById('mobile-final-price-detail').textContent = finalPrice.textContent;
        }
        
        // ì¶”ê°€í˜œíƒ ìƒì„¸ - PCì—ì„œ spanì˜ ë‘ ë²ˆì§¸ ìš”ì†Œ(ê¸ˆì•¡)ë¥¼ ê°€ì ¸ì˜´
        const promotionDiscount = document.getElementById('promotionDiscountDetail');
        const combinationDiscount = document.getElementById('combinationDiscountDetail');
        const partnerCard = document.getElementById('partnerCardDetail');
        
        if (promotionDiscount) {
            const promotionAmount = promotionDiscount.querySelector('span:last-child')?.textContent || '0ì›';
            document.getElementById('mobile-promotion-discount').textContent = promotionAmount;
        }
        if (combinationDiscount) {
            const combinationAmount = combinationDiscount.querySelector('span:last-child')?.textContent || '0ì›';
            document.getElementById('mobile-combination-discount').textContent = combinationAmount;
        }
        if (partnerCard) {
            const partnerAmount = partnerCard.querySelector('span:last-child')?.textContent || '0ì›';
            document.getElementById('mobile-partner-card').textContent = partnerAmount;
        }
        
        // ì„ ë‚©ê¸ˆì•¡ í‘œì‹œ ì—¬ë¶€
        if (prepaymentSection && prepaymentSection.style.display !== 'none') {
            document.getElementById('mobile-prepayment-section').style.display = 'block';
            if (prepaymentPrice) document.getElementById('mobile-prepayment-price').textContent = prepaymentPrice.textContent;
        } else {
            document.getElementById('mobile-prepayment-section').style.display = 'none';
        }
        
        // ì´í˜œíƒ ë³´ê¸° ì²´í¬ ì—¬ë¶€ í™•ì¸ ë° ì´ ë¹„ìš© í‘œì‹œ
        const showTotalCost = document.getElementById('showTotalCost');
        const mobileTotalSection = document.getElementById('mobile-total-cost-section');
        
        if (showTotalCost && showTotalCost.checked && mobileTotalSection) {
            // PCì˜ updateTotalCostSummaryì™€ ë™ì¼í•œ ë¡œì§ ì‚¬ìš©
            if (window.calculator && window.calculator.selectedProducts.length > 0) {
                let totalContractCost = 0;
                let totalBenefits = 0;
                let actualTotalPayment = 0;
                let maxContractMonths = 0;
                
                window.calculator.selectedProducts.forEach(product => {
                    const monthlyFee = window.calculator.parsePrice(product['ì›”ìš”ê¸ˆ']);
                    const contractPeriod = product['ê³„ì•½ê¸°ê°„'];
                    if (!contractPeriod) return;
                    
                    const contractMonths = parseInt(contractPeriod.replace('ë…„', '')) * 12;
                    if (contractMonths > maxContractMonths) maxContractMonths = contractMonths;
                    
                    const totalMonthlyFee = monthlyFee * contractMonths;
                    
                    // ì¹´ë“œ í˜œíƒ ê³„ì‚°
                    let totalCardBenefit = 0;
                    if (product.partnerCard) {
                        const periodInfo = window.calculator.calculatePeriodBasedDiscount(contractPeriod, product.partnerCard);
                        if (periodInfo.promotionPeriod > 0) {
                            totalCardBenefit += Math.min(product.partnerCard.promotionDiscount, monthlyFee) * periodInfo.promotionPeriod;
                        }
                        if (periodInfo.basicPeriod > 0) {
                            totalCardBenefit += Math.min(product.partnerCard.basicDiscount, monthlyFee) * periodInfo.basicPeriod;
                        }
                    }
                    
                    // í™œì„±í™” í˜œíƒ
                    const activationDiscount = window.calculator.parsePrice(product['í™œì„±í™”']) || 0;
                    const promotionMonths = parseInt(product['í”„ë¡œëª¨ì…˜í• ì¸ì¢…ë£Œì›”'] || '0');
                    const totalActivationBenefit = activationDiscount * promotionMonths;
                    
                    // ê²°í•©í• ì¸ í˜œíƒ
                    const combinationDiscount = window.calculator.parsePrice(product['í• ì¸ê¸ˆì•¡']) || 0;
                    const totalCombinationBenefit = combinationDiscount * contractMonths;
                    
                    const productTotalBenefit = totalCardBenefit + totalActivationBenefit + totalCombinationBenefit;
                    const productActualCost = totalMonthlyFee - productTotalBenefit;
                    
                    totalContractCost += totalMonthlyFee;
                    totalBenefits += productTotalBenefit;
                    actualTotalPayment += productActualCost;
                });
                
                // ëª¨ë°”ì¼ ì´ ë¹„ìš© ì„¹ì…˜ ì—…ë°ì´íŠ¸
                document.getElementById('mobile-contract-period').textContent = maxContractMonths ? `${maxContractMonths}ê°œì›”` : '-';
                document.getElementById('mobile-total-original').textContent = totalContractCost > 0 ? `${totalContractCost.toLocaleString()}ì›` : '0ì›';
                document.getElementById('mobile-total-benefits').textContent = totalBenefits > 0 ? `-${totalBenefits.toLocaleString()}ì›` : '-0ì›';
                document.getElementById('mobile-total-cost').textContent = actualTotalPayment > 0 ? `${actualTotalPayment.toLocaleString()}ì›` : '0ì›';
            }
            
            mobileTotalSection.style.display = 'block';
        } else if (mobileTotalSection) {
            mobileTotalSection.style.display = 'none';
        }
    }
    
    // ëª¨ë°”ì¼ UI í‘œì‹œ/ìˆ¨ê¹€ í•¨ìˆ˜
    function updateMobileUI() {
        const isMobile = window.innerWidth <= 768;
        const benefitPanel = document.getElementById('mobile-benefit-panel');
        const totalToggle = document.getElementById('mobileTotalToggle');
        const container = document.getElementById('mobile-buttons-container');
        
        if (isMobile) {
            // ëª¨ë°”ì¼: íŒ¨ë„ê³¼ í† ê¸€ í‘œì‹œ
            if (benefitPanel) benefitPanel.style.display = 'block';
            if (totalToggle) totalToggle.style.display = 'flex';
            // createMobileButtons(); // ì œê±°ë¨
        } else {
            // ë°ìŠ¤í¬í†±: ëª¨ë°”ì¼ ìš”ì†Œë“¤ ìˆ¨ê¹€
            if (benefitPanel) benefitPanel.style.display = 'none';
            if (totalToggle) totalToggle.style.display = 'none';
            if (container) container.remove();
        }
    }
    
    // ëª¨ë°”ì¼ì—ì„œ user-info-container ìœ„ì¹˜ ì¡°ì • (ì „ì—­ í•¨ìˆ˜ë¡œ ì´ë™)
    function adjustUserInfoPosition() {
            const container = document.getElementById('user-info-container');
            if (!container) return;
            
            const isMobile = window.innerWidth <= 768;
            
            if (isMobile) {
                // ëª¨ë°”ì¼: í—¤ë”ë¡œ ì´ë™
                container.style.position = '';
                container.style.top = '';
                container.style.right = '';
                container.style.zIndex = '';
                
                const headerContent = document.querySelector('.header-content');
                if (headerContent && !headerContent.contains(container)) {
                    headerContent.appendChild(container);
                }
                
                // êµ¬ë…í˜œíƒ ë²„íŠ¼ ì¶”ê°€ (ëª¨ë°”ì¼ì—ì„œë§Œ)
                const backToMain = container.querySelector('.back-to-main');
                if (backToMain && !container.querySelector('.mobile-benefits-btn')) {
                    const benefitsBtn = document.createElement('a');
                    benefitsBtn.className = 'mobile-benefits-btn';
                    benefitsBtn.href = '#';
                    benefitsBtn.style.cssText = 'text-decoration: none; color: #666; font-size: 12px; display: flex; align-items: center; gap: 5px; padding: 6px 10px; background: white; border-radius: 6px; transition: all 0.2s; box-shadow: 0 2px 8px rgba(0,0,0,0.1); border: 1px solid #ddd; height: 32px; box-sizing: border-box; white-space: nowrap;';
                    benefitsBtn.innerHTML = '<span style="font-size: 16px;">ğŸ</span> êµ¬ë…í˜œíƒ';
                    
                    benefitsBtn.onclick = (e) => {
                        e.preventDefault();
                        const desktopBtn = document.querySelector('.subscription-benefits-btn');
                        if (desktopBtn) desktopBtn.click();
                    };
                    
                    benefitsBtn.onmouseover = function() {
                        this.style.background = '#f5f5f5';
                        this.style.color = '#333';
                    };
                    benefitsBtn.onmouseout = function() {
                        this.style.background = 'white';
                        this.style.color = '#666';
                    };
                    
                    container.insertBefore(benefitsBtn, backToMain);
                }
            } else {
                // PC: ì›ë˜ ìœ„ì¹˜ë¡œ ë³µì›
                container.style.position = 'fixed';
                container.style.top = '25px';
                container.style.right = '30px';
                container.style.zIndex = '1000';
                
                // bodyë¡œ ë‹¤ì‹œ ì´ë™
                if (!document.body.contains(container) || container.parentElement !== document.body) {
                    document.body.appendChild(container);
                }
                
                // ëª¨ë°”ì¼ êµ¬ë…í˜œíƒ ë²„íŠ¼ ì œê±°
                const mobileBenefitsBtn = container.querySelector('.mobile-benefits-btn');
                if (mobileBenefitsBtn) {
                    mobileBenefitsBtn.remove();
                }
        }
    }
    
    // DOM ë¡œë“œ í›„ ì‹¤í–‰
    document.addEventListener('DOMContentLoaded', () => {
        // createMobileButtons(); // ì œê±°ë¨
        updateMobileUI();
        
        // ì´ˆê¸° ë¡œë“œ ì‹œ ëª¨ë°”ì¼ íŒ¨ë„ ì—…ë°ì´íŠ¸
        if (window.innerWidth <= 768) {
            setTimeout(() => {
                updateMobileBenefitPanel();
            }, 500);
        }
        
        // MutationObserverë¡œ user-info-container ìƒì„± ê°ì§€
        const observer = new MutationObserver((mutations) => {
            mutations.forEach((mutation) => {
                mutation.addedNodes.forEach((node) => {
                    if (node.id === 'user-info-container') {
                        adjustUserInfoPosition();
                    }
                });
            });
        });
        
        observer.observe(document.body, { 
            childList: true, 
            subtree: true 
        });
        
        // ì´ë¯¸ ì¡´ì¬í•˜ëŠ” ê²½ìš° ì¦‰ì‹œ ì¡°ì •
        adjustUserInfoPosition();
        
        // ê³„ì‚°ê¸° ì—…ë°ì´íŠ¸ ê°ì§€ (ëª¨ë°”ì¼ íŒ¨ë„ ì—…ë°ì´íŠ¸ìš©)
        const calculatorObserver = new MutationObserver(() => {
            if (window.innerWidth <= 768) {
                console.log('ê³„ì‚°ê¸° ì—…ë°ì´íŠ¸ ê°ì§€ - ëª¨ë°”ì¼ íŒ¨ë„ ì—…ë°ì´íŠ¸');
                updateMobileBenefitPanel();
            }
        });
        
        const finalPriceEl = document.getElementById('finalPrice');
        if (finalPriceEl) {
            calculatorObserver.observe(finalPriceEl, { 
                childList: true, 
                characterData: true,
                subtree: true 
            });
        }
        
        // PC ê³„ì‚°ê¸°ì˜ ëª¨ë“  ìš”ì†Œ ê°ì§€
        const normalPriceEl = document.getElementById('normalPrice');
        if (normalPriceEl) {
            calculatorObserver.observe(normalPriceEl, { 
                childList: true, 
                characterData: true,
                subtree: true 
            });
        }
        
        // ì´í˜œíƒ ë³´ê¸° ì²´í¬ë°•ìŠ¤ ë³€ê²½ ê°ì§€
        const showTotalCost = document.getElementById('showTotalCost');
        const mobileShowTotalCost = document.getElementById('mobileShowTotalCost');
        
        if (showTotalCost) {
            showTotalCost.addEventListener('change', () => {
                console.log('PC ì´í˜œíƒ ì²´í¬ë°•ìŠ¤ ë³€ê²½:', showTotalCost.checked);
                // ì œí’ˆ ì¹´ë“œì˜ ì´ ë¹„ìš© ì„¹ì…˜ í‘œì‹œ/ìˆ¨ê¹€
                if (window.calculator) {
                    window.calculator.toggleTotalCostDisplay(showTotalCost.checked);
                }
                if (window.innerWidth <= 768) {
                    // ëª¨ë°”ì¼ ì²´í¬ë°•ìŠ¤ë„ ë™ê¸°í™”
                    if (mobileShowTotalCost) {
                        mobileShowTotalCost.checked = showTotalCost.checked;
                    }
                    updateMobileBenefitPanel();
                }
            });
        }
        
        if (mobileShowTotalCost) {
            mobileShowTotalCost.addEventListener('change', () => {
                console.log('ëª¨ë°”ì¼ ì´í˜œíƒ ì²´í¬ë°•ìŠ¤ ë³€ê²½:', mobileShowTotalCost.checked);
                // PC ì²´í¬ë°•ìŠ¤ë„ ë™ê¸°í™”
                if (showTotalCost) {
                    showTotalCost.checked = mobileShowTotalCost.checked;
                }
                // ì œí’ˆ ì¹´ë“œì˜ ì´ ë¹„ìš© ì„¹ì…˜ í‘œì‹œ/ìˆ¨ê¹€
                if (window.calculator) {
                    window.calculator.toggleTotalCostDisplay(mobileShowTotalCost.checked);
                }
                updateMobileBenefitPanel();
            });
        }
    });
    
    // í™”ë©´ í¬ê¸° ë³€ê²½ ì‹œ ë‹¤ì‹œ ì²´í¬
    window.addEventListener('resize', () => {
        updateMobileUI();
        adjustUserInfoPosition();
    });
    
    // ì „ì—­ í•¨ìˆ˜ë¡œ ë…¸ì¶œ
    window.toggleBenefitPanel = toggleBenefitPanel;
    </script>
</body>
</html>