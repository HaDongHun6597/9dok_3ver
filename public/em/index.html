<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>êµ¬ë… ê°„í¸ì¡°íšŒ - ì´ë§ˆíŠ¸</title>
    <link rel="stylesheet" href="../shared/style.css">
    <link rel="stylesheet" href="../style.css">
    <link rel="stylesheet" href="../mobile.css">
    <script>window.CHANNEL = 'em';</script>
</head>
<body>
    <script src="/auth.js"></script>
    <div class="container">
        <!-- í—¤ë” -->
        <header class="header">
            <div class="header-content">
                <h1>êµ¬ë… ê°„í¸ì¡°íšŒ<span class="channel-version">&nbsp; (ì´ë§ˆíŠ¸) ver3</span></h1>
                <a href="/" class="back-to-main" style="position: fixed; right: 220px; top: 25px; text-decoration: none; color: #666; font-size: 13px; display: flex; align-items: center; gap: 5px; padding: 8px 12px; background: white; border-radius: 6px; transition: all 0.2s; box-shadow: 0 2px 8px rgba(0,0,0,0.1); border: 1px solid #ddd; height: 36px; box-sizing: border-box;" onmouseover="this.style.background='#f5f5f5'; this.style.color='#333';" onmouseout="this.style.background='white'; this.style.color='#666';">
                    <span style="font-size: 16px;">â†</span> ì±„ë„ ì„ íƒ
                </a>
            </div>
        </header>

        <div class="main-content">
            <!-- ì™¼ìª½ ê³„ì‚°ê¸° ì˜ì—­ -->
            <aside class="calculator-sidebar">
                <div class="calculator-header">
                    <h2>ê°€ì „êµ¬ë… í˜œíƒ</h2>
                    <label style="position: absolute; right: 10px; top: 50%; transform: translateY(-50%); display: flex; align-items: center; font-size: 12px; color: #666; cursor: pointer;">
                        <input type="checkbox" id="showTotalCost" style="margin-right: 5px; cursor: pointer;">
                        ì´í˜œíƒ ë³´ê¸°
                    </label>
                </div>
                
                <!-- êµ¬ë… íƒ€ì…ë³„ í˜œíƒ -->
                <div class="benefit-section">
                    <div class="benefit-item active" data-type="single">
                        <div class="benefit-title">ì •ìƒ êµ¬ë…ë£Œ</div>
                        <div class="benefit-price" id="normalPrice">0ì›</div>
                    </div>
                    
                    <div class="benefit-item" data-type="promotion">
                        <div class="benefit-header">
                            <div class="benefit-title">ì¶”ê°€í˜œíƒ</div>
                        </div>
                        <div class="benefit-price" id="promotionPrice">0ì›</div>
                        <div class="benefit-details" id="benefitDetails">
                            <div class="benefit-detail" id="promotionDiscountDetail">â€¢ í”„ë¡œëª¨ì…˜í• ì¸: 0ì›</div>
                            <div class="benefit-detail" id="combinationDiscountDetail">â€¢ ê²°í•©í• ì¸: 0ì›</div>
                            <div class="benefit-detail" id="partnerCardDetail">â€¢ ì œíœ´ì¹´ë“œ: 0ì›</div>
                        </div>
                    </div>
                    
                    <div class="benefit-item prepayment-section" id="prepaymentSection" style="display: none;">
                        <div class="benefit-title">ì„ ë‚©ê¸ˆì•¡ ğŸ’³</div>
                        <div class="benefit-price prepayment-price" id="prepaymentPrice">0ì›</div>
                        <div class="benefit-details">
                            <div class="benefit-detail small-text">ì„ ë‚© ì„ íƒ ì‹œ í•œë²ˆì— ë‚©ë¶€í•  ê¸ˆì•¡</div>
                            <div class="benefit-detail" id="prepaymentDetail">â€¢ í•´ë‹¹ ì œí’ˆ ì—†ìŒ</div>
                        </div>
                    </div>
                </div>
                
                <div class="final-total">
                    <div class="final-message">ìµœì¢… ì²´ê° êµ¬ë…ë£Œ(ì›”)ì…ë‹ˆë‹¤.</div>
                    <div class="final-price" id="finalPrice">0ì›</div>
                </div>
            </aside>

            <!-- ìš°ì¸¡ ì œí’ˆ ì„ íƒ ì˜ì—­ -->
            <main class="products-main">
                <div class="products-header">
                    <button id="subscriptionBenefitsBtn" class="subscription-benefits-btn">
                        <span class="benefits-icon">ğŸ</span>
                        <span>êµ¬ë… í˜œíƒ</span>
                    </button>
                </div>
                <div class="products-grid" id="productsGrid">
                    <!-- ì„ íƒëœ ì œí’ˆ ì¹´ë“œë“¤ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
                    <div class="add-product-card" id="addProductCard">
                        <div class="add-product-content">
                            <div class="add-icon">+</div>
                            <div class="add-text">ì œí’ˆ ì¶”ê°€</div>
                        </div>
                    </div>
                </div>
                
                <!-- ì›°ì»´ ë©”ì‹œì§€ (ì œí’ˆì´ ì—†ì„ ë•Œ) -->
                <div class="welcome-message" id="welcomeMessage">
                    <h3>êµ¬ë…í•˜ê³  ì‹¶ì€ ì œí’ˆì„ ì„ íƒí•´ë³´ì„¸ìš”</h3>
                    <p>ë‹¤ì–‘í•œ ê°€ì „ì œí’ˆì„ ì›” êµ¬ë…ë£Œë¡œ ì´ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
                </div>
            </main>
        </div>
        
        <!-- ì›Œí„°ë§ˆí¬ ì‹œê·¸ë‹ˆì²˜ -->
        <div class="watermark-signature">designed by í•˜ë™í›ˆ</div>
    </div>
    
    <!-- ëª¨ë°”ì¼ í•˜ë‹¨ í˜œíƒ íŒ¨ë„ -->
    <div id="mobile-benefit-panel" class="mobile-benefit-panel collapsed" style="display: none;">
        <div class="mobile-benefit-header" onclick="toggleBenefitPanel()">
            <span id="benefit-panel-text">ê°€ì „ êµ¬ë… í˜œíƒ â–²</span>
        </div>
        <div class="mobile-benefit-content">
            <div style="text-align: center; margin-bottom: 20px;">
                <h3 style="color: #333; font-size: 16px; margin: 0 0 10px 0;">ğŸ ê°€ì „ êµ¬ë… í˜œíƒ</h3>
                <p style="color: #666; font-size: 12px; margin: 0;">ì›” êµ¬ë…ë£Œë¡œ ì´ìš©í•˜ëŠ” ë‹¤ì–‘í•œ í˜œíƒì„ í™•ì¸í•´ë³´ì„¸ìš”</p>
            </div>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
                <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; text-align: center;">
                    <div style="font-size: 20px; margin-bottom: 8px;">ğŸ› ï¸</div>
                    <div style="font-size: 12px; font-weight: 600; color: #333;">ì„¤ì¹˜/ì² ê±° ë¬´ë£Œ</div>
                    <div style="font-size: 10px; color: #666; margin-top: 4px;">ì „ë¬¸ ê¸°ì‚¬ ë°©ë¬¸</div>
                </div>
                <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; text-align: center;">
                    <div style="font-size: 20px; margin-bottom: 8px;">ğŸ”§</div>
                    <div style="font-size: 12px; font-weight: 600; color: #333;">A/S ë¬´ì œí•œ</div>
                    <div style="font-size: 10px; color: #666; margin-top: 4px;">ê³ ì¥ ì‹œ ì¦‰ì‹œ ìˆ˜ë¦¬</div>
                </div>
                <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; text-align: center;">
                    <div style="font-size: 20px; margin-bottom: 8px;">ğŸšš</div>
                    <div style="font-size: 12px; font-weight: 600; color: #333;">ë°°ì†¡ ë¬´ë£Œ</div>
                    <div style="font-size: 10px; color: #666; margin-top: 4px;">ì„¤ì¹˜ê¹Œì§€ ì›ìŠ¤í†±</div>
                </div>
                <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; text-align: center;">
                    <div style="font-size: 20px; margin-bottom: 8px;">ğŸ’°</div>
                    <div style="font-size: 12px; font-weight: 600; color: #333;">ê²½ì œì </div>
                    <div style="font-size: 10px; color: #666; margin-top: 4px;">ì›” ì†Œì•¡ìœ¼ë¡œ ì´ìš©</div>
                </div>
            </div>
        </div>
    </div>

    <!-- ì œí’ˆ ì„ íƒ ëª¨ë‹¬ -->
    <div id="productModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>ì œí’ˆ ì„ íƒ</h2>
                <span class="close-btn" id="closeModal">&times;</span>
            </div>
            
            <!-- ë‹¨ê³„ í‘œì‹œê¸° -->
            <div class="step-indicator">
                <div class="step active" data-step="1">
                    <span class="step-number">1</span>
                    <span class="step-label">ì œí’ˆêµ°</span>
                </div>
                <div class="step" data-step="2">
                    <span class="step-number">2</span>
                    <span class="step-label">ëª¨ë¸ëª…</span>
                </div>
                <div class="step" data-step="3">
                    <span class="step-number">3</span>
                    <span class="step-label">ê²°í•©ìœ í˜•</span>
                </div>
                <div class="step" data-step="4">
                    <span class="step-number">4</span>
                    <span class="step-label">ê³„ì•½ê¸°ê°„</span>
                </div>
                <div class="step" data-step="5">
                    <span class="step-number">5</span>
                    <span class="step-label">ê´€ë¦¬ìœ í˜•</span>
                </div>
                <div class="step" data-step="6">
                    <span class="step-number">6</span>
                    <span class="step-label">ë°©ë¬¸ì£¼ê¸°</span>
                </div>
                <div class="step" data-step="7">
                    <span class="step-number">7</span>
                    <span class="step-label">ì„ ë‚©</span>
                </div>
            </div>

            <!-- ìŠ¤í¬ë¡¤ ê°€ëŠ¥í•œ ë‚´ìš© ì˜ì—­ -->
            <div class="modal-scroll-content">
                <!-- ë‹¨ê³„ë³„ ì„ íƒ ì˜ì—­ -->
                <div class="step-content">
                    <div class="step-header">
                        <div class="step-title" id="stepTitle">ì œí’ˆêµ°ì„ ì„ íƒí•´ì£¼ì„¸ìš”</div>
                        <button id="prevBtnTop" class="btn btn-secondary btn-small" style="display: none;">â† ì´ì „</button>
                    </div>
                    
                    <!-- ê²€ìƒ‰ì°½ (ë§ì€ ì˜µì…˜ì´ ìˆì„ ë•Œë§Œ í‘œì‹œ) -->
                    <div class="search-section" id="searchSection" style="display: none;">
                        <input type="text" id="optionSearch" placeholder="ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•˜ì„¸ìš”..." />
                        <div class="search-result-count" id="searchResultCount"></div>
                    </div>
                    
                    <div class="options-grid" id="optionsGrid">
                        <!-- ì„ íƒ ì˜µì…˜ë“¤ì´ ë™ì ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤ -->
                    </div>
                </div>

                <!-- ì„ íƒ ë‚´ì—­ í‘œì‹œ -->
                <div class="selection-summary">
                    <h4>ì„ íƒ ë‚´ì—­</h4>
                    <div class="selection-items" id="selectionItems">
                        <!-- ì„ íƒëœ ë‚´ì—­ë“¤ì´ í‘œì‹œë©ë‹ˆë‹¤ -->
                    </div>
                </div>

                <!-- ë²„íŠ¼ ì˜ì—­ (ìë™ ì§„í–‰ìœ¼ë¡œ ì¸í•´ ìˆ¨ê¹€) -->
                <div class="modal-footer" style="display: none;">
                    <button id="skipBtn" class="btn btn-secondary">ê±´ë„ˆë›°ê¸°</button>
                    <button id="addBtn" class="btn btn-success">ì œí’ˆ ì¶”ê°€</button>
                </div>
            </div>
        </div>
    </div>

    <!-- ì œíœ´ì¹´ë“œ ëª¨ë‹¬ -->
    <div id="partnerCardModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>ì œíœ´ì¹´ë“œ ì„ íƒ</h2>
                <span class="close-btn" onclick="calculator.closePartnerCardModal()">&times;</span>
            </div>
            
            <div class="modal-body">
                <p>ì œí’ˆì— ì ìš©í•  ì œíœ´ì¹´ë“œë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.</p>
                <div id="partnerCardOptions" class="partner-card-grid">
                    <!-- ì œíœ´ì¹´ë“œ ì˜µì…˜ë“¤ì´ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤ -->
                </div>
            </div>
            
            <div class="modal-footer">
                <button onclick="calculator.closePartnerCardModal()" class="btn btn-secondary">ì·¨ì†Œ</button>
                <button onclick="calculator.applyPartnerCard()" class="btn btn-primary">ì ìš©</button>
            </div>
        </div>
    </div>

    <!-- êµ¬ë… í˜œíƒ ëª¨ë‹¬ -->
    <div id="subscriptionBenefitsModal" class="modal">
        <div class="modal-content benefits-modal-content">
            <div class="modal-header">
                <h2>êµ¬ë… í˜œíƒ</h2>
                <span class="close-btn" onclick="closeBenefitsModal()">&times;</span>
            </div>
            
            <div class="modal-body">
                <p>êµ¬ë… ì‹œ ë°›ì„ ìˆ˜ ìˆëŠ” ë‹¤ì–‘í•œ ì¼€ì–´ ì„œë¹„ìŠ¤ í˜œíƒì„ í™•ì¸í•´ë³´ì„¸ìš”.</p>
                <div id="benefitsGrid" class="benefits-grid">
                    <!-- êµ¬ë… í˜œíƒ ë²„íŠ¼ë“¤ì´ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤ -->
                </div>
            </div>
        </div>
    </div>

    <!-- êµ¬ë… í˜œíƒ ìƒì„¸ ëª¨ë‹¬ -->
    <div id="benefitDetailModal" class="modal">
        <div class="modal-content benefit-detail-content">
            <div class="modal-header">
                <h2 id="benefitDetailTitle">í˜œíƒ ìƒì„¸</h2>
                <span class="close-btn" onclick="closeBenefitDetailModal()">&times;</span>
            </div>
            
            <div class="modal-body">
                <div id="benefitDetailContent">
                    <!-- ìƒì„¸ ë‚´ìš©ì´ ì—¬ê¸°ì— ë¡œë“œë©ë‹ˆë‹¤ -->
                </div>
            </div>
        </div>
    </div>

    <script src="../shared/script.js"></script>
    <script src="../product-modal.js"></script>
    <script src="../script.js"></script>
    
    <!-- ëª¨ë°”ì¼ 3ê°œ ë²„íŠ¼ ìƒì„± ìŠ¤í¬ë¦½íŠ¸ -->
    <script>
    function createMobileButtons() {
        // ì´ë¯¸ ë²„íŠ¼ì´ ìˆìœ¼ë©´ ìƒì„±í•˜ì§€ ì•ŠìŒ
        if (document.getElementById('mobile-buttons-container')) return;
        
        // ëª¨ë°”ì¼ì—ì„œë§Œ ì‹¤í–‰
        if (window.innerWidth > 768) return;
        
        // í—¤ë” ì»¨í…ì¸  ì°¾ê¸°
        const headerContent = document.querySelector('.header-content');
        if (!headerContent) return;
        
        // 3ê°œ ë²„íŠ¼ ì»¨í…Œì´ë„ˆ ìƒì„±
        const buttonsContainer = document.createElement('div');
        buttonsContainer.id = 'mobile-buttons-container';
        buttonsContainer.style.cssText = `
            display: flex !important;
            gap: 8px !important;
            margin-top: 15px !important;
            width: 100% !important;
        `;
        
        // 1. êµ¬ë…í˜œíƒ ë²„íŠ¼
        const benefitsBtn = document.createElement('button');
        benefitsBtn.innerHTML = '<span style="font-size: 16px; margin-bottom: 2px;">ğŸ</span><br>êµ¬ë…í˜œíƒ';
        benefitsBtn.onclick = () => document.getElementById('subscriptionBenefitsBtn').click();
        benefitsBtn.style.cssText = `
            flex: 1 !important;
            padding: 10px 5px !important;
            background: white !important;
            border: 1px solid #ddd !important;
            border-radius: 8px !important;
            font-size: 11px !important;
            color: #333 !important;
            text-decoration: none !important;
            min-height: 50px !important;
            cursor: pointer !important;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1) !important;
            font-weight: 500 !important;
            line-height: 1.2 !important;
            display: flex !important;
            flex-direction: column !important;
            align-items: center !important;
            justify-content: center !important;
        `;
        
        // 2. ì±„ë„ì„ íƒ ë²„íŠ¼
        const channelBtn = document.createElement('a');
        channelBtn.href = '/';
        channelBtn.innerHTML = '<span style="font-size: 16px; margin-bottom: 2px;">ğŸª</span><br>ì±„ë„ì„ íƒ';
        channelBtn.style.cssText = `
            flex: 1 !important;
            padding: 10px 5px !important;
            background: white !important;
            border: 1px solid #ddd !important;
            border-radius: 8px !important;
            font-size: 11px !important;
            color: #333 !important;
            text-decoration: none !important;
            min-height: 50px !important;
            cursor: pointer !important;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1) !important;
            font-weight: 500 !important;
            line-height: 1.2 !important;
            display: flex !important;
            flex-direction: column !important;
            align-items: center !important;
            justify-content: center !important;
        `;
        
        // 3. ë¡œê·¸ì¸ì •ë³´ ë²„íŠ¼
        const loginBtn = document.createElement('button');
        loginBtn.innerHTML = '<span style="font-size: 16px; margin-bottom: 2px;">ğŸ‘¤</span><br>ë¡œê·¸ì¸ì •ë³´';
        loginBtn.onclick = () => {
            // ì‚¬ìš©ì ì •ë³´ í‘œì‹œ ë˜ëŠ” ë¡œê·¸ì•„ì›ƒ
            const userInfo = localStorage.getItem('user_info');
            if (userInfo) {
                const user = JSON.parse(userInfo);
                if (confirm(`${user.username}ë‹˜, ë¡œê·¸ì•„ì›ƒ í•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
                    handleLogout();
                }
            }
        };
        loginBtn.style.cssText = `
            flex: 1 !important;
            padding: 10px 5px !important;
            background: white !important;
            border: 1px solid #ddd !important;
            border-radius: 8px !important;
            font-size: 11px !important;
            color: #333 !important;
            text-decoration: none !important;
            min-height: 50px !important;
            cursor: pointer !important;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1) !important;
            font-weight: 500 !important;
            line-height: 1.2 !important;
            display: flex !important;
            flex-direction: column !important;
            align-items: center !important;
            justify-content: center !important;
        `;
        
        // ë²„íŠ¼ë“¤ì„ ì»¨í…Œì´ë„ˆì— ì¶”ê°€
        buttonsContainer.appendChild(benefitsBtn);
        buttonsContainer.appendChild(channelBtn);
        buttonsContainer.appendChild(loginBtn);
        
        // í—¤ë” ì»¨í…ì¸ ì— ì¶”ê°€
        headerContent.appendChild(buttonsContainer);
    }
    
    // í•˜ë‹¨ í˜œíƒ íŒ¨ë„ í† ê¸€ í•¨ìˆ˜
    function toggleBenefitPanel() {
        const panel = document.getElementById('mobile-benefit-panel');
        const text = document.getElementById('benefit-panel-text');
        
        if (panel.classList.contains('collapsed')) {
            panel.classList.remove('collapsed');
            panel.classList.add('expanded');
            text.textContent = 'ê°€ì „ êµ¬ë… í˜œíƒ â–¼';
        } else {
            panel.classList.remove('expanded');
            panel.classList.add('collapsed');
            text.textContent = 'ê°€ì „ êµ¬ë… í˜œíƒ â–²';
        }
    }
    
    // ëª¨ë°”ì¼ UI í‘œì‹œ/ìˆ¨ê¹€ í•¨ìˆ˜
    function updateMobileUI() {
        const isMobile = window.innerWidth <= 768;
        const benefitPanel = document.getElementById('mobile-benefit-panel');
        const container = document.getElementById('mobile-buttons-container');
        
        if (isMobile) {
            // ëª¨ë°”ì¼: ë²„íŠ¼ê³¼ íŒ¨ë„ í‘œì‹œ
            if (benefitPanel) benefitPanel.style.display = 'block';
            createMobileButtons();
        } else {
            // ë°ìŠ¤í¬í†±: ëª¨ë°”ì¼ ìš”ì†Œë“¤ ìˆ¨ê¹€
            if (benefitPanel) benefitPanel.style.display = 'none';
            if (container) container.remove();
        }
    }
    
    // DOM ë¡œë“œ í›„ ì‹¤í–‰
    document.addEventListener('DOMContentLoaded', () => {
        createMobileButtons();
        updateMobileUI();
    });
    
    // í™”ë©´ í¬ê¸° ë³€ê²½ ì‹œ ë‹¤ì‹œ ì²´í¬
    window.addEventListener('resize', updateMobileUI);
    
    // ì „ì—­ í•¨ìˆ˜ë¡œ ë…¸ì¶œ
    window.toggleBenefitPanel = toggleBenefitPanel;
    </script>
</body>
</html>